\chapter{需求分析}

本章首次对分布式对象内存管理系统作出了整体功能上的概括，从功能性与非功能性两个角度剖析了分布式对象存储系统管控平台的总体要
求。需求分析工作是分布式对象存储系统管控平台研发的关键步骤，正确进行需求分析工作将有利于以后的工作顺利进行。

\section{功能性需求}

分布式对象存储系统管控平台，是集文件存放功能与系统管理为一身的综合系统。
本系统中有系统管理员、企业管理员和普通用户三种角色。系统管理员掌握对操作系统中各种功能的运行权限，重点是能够监测系统状态并及时对系统进行修复企业拥有
对部分使用者、分组和访问策略的管理权限，如查看部分用户信息和分组信息，对用户或分组进行禁用，修改用户或分组的访问策略等；而普通用户则拥有对Bucket管理和文件上传、下载以及共享等权限。
从系统管理员企业和普通用户三种不同角色用户的角度进行需求分析，可得到用户需求表\ref{用户需求表}。


% 存储用户是整个分布式对象存储系统的直接服务群体，他们注册属于自己的账号之后，可以直接创建自己的存储桶（Bucket），在每个Bucket中上传、下载文件（Object），支持多种文件类型，
% 用户可对自己的Bucket进行管理，也支持多文件同时上传和下载。用户可对Bucket进行创建、删除（Bucket为空时）、重命名以及访问策略的设置。

% 系统管理员主要负责用户数据、用户分组、访问策略、系统日志和状态的管理，因此他们还必须对已登录注册的用户和分组进行控制。通常，系统管理员登录到系统管理时首先会检查用户列表、分组情况、存储使用情况和系统状态等。还应特别关注系统的告警信息，对系统进行及时的修复。对于用户访问策略以及分组
% 的访问策略也必须由系统管理员负责，主要是为了资源的隔离，用户的最终访问策略由用户个人访问策略和分组访问策略共同决定，即用户最终访问策略=用户访问策略+分组访问策略。


\begin{center}
    \renewcommand\arraystretch{1.5}{
    \setlength{\tabcolsep}{5mm}{
	\begin{longtable}{|p{2.2cm}<{\centering}|p{3.4cm}<{\centering}|p{5.6cm}<{\centering}|}
		\caption{用户需求表}\label{用户需求表}\\
		\hline
        \bf{需求编号} & \bf{需求名称} & \bf{需求说明} \\
        \hline
        R01 & 用户注册 & 企业管理员和普通用户需要注册登录账号 \\
        \hline
        R02 & 用户登录 & 所有人员登录系统后方可操作 \\
        \hline
        R03 & 用户信息的增删改查 & 所有管理员创建、删除、修改和查询用户信息 \\
        \hline
        R04 & 分组信息的增删改查 & 所有管理员创建、删除、修改和查询分组信息 \\
        \hline
        R05 & 组分配 & 所有管理员给用户分配对应的组 \\
        \hline
        R06 & 策略信息的增删改查 & 系统管理员创建、删除、修改和查询策略信息 \\
        \hline
        R07 & 策略分配 & 系统管理员给用户和组分配策略 \\
        \hline
        R08 & 权限信息的增删改查 & 系统管理员创建、删除、修改和查询权限信息 \\
        \hline
        R09 & 权限分配 & 系统管理员给用户分配权限 \\
        \hline
        R10 & 角色信息查询 & 系统管理员查询角色信息 \\
        \hline
        R11 & 角色分配 & 系统管理员给用户分配对应的角色 \\
        \hline
        R12 & 桶信息的增删改查 & 所有人员创建、删除、修改和查询存储桶信息 \\
        \hline
        R13 & 桶的生命周期设置 & 所有人员设置存储桶的生命周期 \\
        \hline
        R14 & 文件上传 & 普通用户进行文件上传 \\
        \hline
        R15 & 文件下载 & 普通用户进行文件下载 \\
        \hline
        R16 & 文件共享 & 普通用户进行文件共享 \\
        \hline
        R17 & 系统状态查询 & 系统管理员查询系统存储状态 \\
        \hline
        R18 & 记录信息查询 & 系统管理员查询操作记录信息 \\
        \hline
        R19 & 告警信息查询 & 系统管理员查询系统的告警信息 \\
        \hline
      
	\end{longtable}}}
\end{center}

根据系统的角色设定和需求表中不同角色用户的需求，可以得到系统的用例图\ref{fig:系统用例图}。

% 系统管理员是在系统首次部署运行时由开发人员手动创建，该用户拥有该系统管理的最高权限，只有阿里内部的存储系统维护人员才持有该账号。系统管理员主要负责用户权限、访问策略的创建与分配，同时也负责
% 将角色分配给各种用户，企业和普通用户（用户）。当企业使用该存储服务时，就会给各企业的内部人员分企业角色，方便企业管理自己的用户。
\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{my_figures/chapter3/系统用例图.png}
    \caption{系统用例图}
    \label{fig:系统用例图}
%     \note{注：图注的内容不宜放到图题中。}
\end{figure}
%企业和普通用户一样，在首次进入系统时都需要注册账号，注册时需要选择是注册管理员账号还是用户账号，如果是管理员账号，则需要填写与阿里系统管理员协商的对应密钥以及完整的公司信息，后台会对密钥和信息进行审核和校验，审核通过后，
% 用户账号的相关信息会被添加进系统。如果是普通用户账号，则只需要填写账号名称、密码等信息即可完成注册。



根据用户需求表\ref{用户需求表}和系统用例图\ref{fig:系统用例图}可以得到系统的用例表，其中超级管理的系统用例包含表的所有内容企业的系统用例包含注册、登录、用户管理、分组管理和存储桶管理，
普通用户的系统用例包含注册、登录、存储桶管理和文件存取。

\begin{center}
    \renewcommand\arraystretch{1.5}{
    \setlength{\tabcolsep}{5mm}{
	\begin{longtable}{|p{2.2cm}<{\centering}|p{3.4cm}<{\centering}|p{5.6cm}<{\centering}|}
		\caption{系统用例表}\label{系统用例表}\\
		\hline
        \bf{用例编号} & \bf{用例名称} & \bf{涉及的需求编号} \\
        \hline
        UC01 & 注册 & R01 \\
        \hline
        UC02 & 登录 & R02 \\
        \hline
        UC03 & 用户管理 & R03 \\
        \hline
        UC04 & 分组管理 & R04,R05 \\
        \hline
        UC05 & 策略管理 & R06,R07 \\
        \hline
        UC06 & 权限管理 & R08,R09 \\
        \hline
        UC07 & 角色管理 & R10,R11 \\
        \hline
        UC08 & 存储桶管理 & R12,R13 \\
        \hline
        UC09 & 文件存取 & R14,R15,R16 \\
        \hline
        UC10 & 系统监控 & R17,R18,R19 \\
        \hline
      
	\end{longtable}}}
\end{center}

\subsection{系统管理员功能需求}

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{my_figures/chapter3/系统管理员用例图.png}
    \caption{系统管理员用例图}
    \label{fig:系统管理员用例图}
%     \note{注：图注的内容不宜放到图题中。}
\end{figure}

系统管理员的主要职责是对用户数据、访问策略和整个存储系统的状态进行统一的管理。系统管理员是在系统首次部署运行时由开发人员手动创建，该用户拥有该系统管理的最高权限，
只有提供存储服务的公司内部的系统维护人员才持有该账号。为了避免重复，我们这里仅介绍系统管理员特有的功能需求。系统管理员的用例图如图\ref{fig:系统管理员用例图}所示。


系统管理员的特有职能主要包括权限管理、角色管理、策略管理和系统监控。这里的权限管理指的是对微服务接口访问权限的管理，一般将一个功能接口作为一个单独的权限。添加权限实际上就是添加新的功能接口，通过将功能暴露给角色使其拥有访问该接口
的权限。对于角色管理，目前系统只支持默认的三种角色，即系统管理员、企业管理员和普通用户，不可创建新角色和删除默认的角色，系统管理员仅可对角色进行查询和分配操作，将
用户与特定角色进行绑定，使其拥有特定角色的权限。

策略管理功能是本系统比较重要的功能，系统中的策略主要分为Bucket访问策略和用户访问策略。Bucket访问策略主要有
public、custom和private三种，系统内置的用户访问策略主要有五种，分别是控制台管理员（consoleAdmin）策略、诊断（diagnostics）策略、只读（readonly）策略、读写
（readwrite）策略和只写（writeonly）策略。对于这些默认策略，系统管理员只能进行查询操作，不能删除。但可以根据需要创建新的用户访问策略，并将这些策略分配给用户和组，
用户的最终访问策略由用户个人访问策略和分组访问策略共同决定，即用户最终访问策略=用户访问策略+分组访问策略。

系统监控功能主要包括状态监测、记录跟踪和告警通知三个子功能，这些子功能有助于系统管理员对系统进行维护，是系统管理员对于系统运行情况的主要信息来源，管理员对这些
信息分析以及时维护或修复系统。

\subsection{企业管理员功能需求}

企业管理员是使用阿里存储服务的企业的管理人员，企业管理员可以对本公司内部人员或客户的数据和权限进行统一的管理。企业管理人员在首次进入系统时也需要注册账号，注册时需
要填写与系统管理员协商的对应密钥以及完整的公司信息，后台会对密钥和信息进行审核和校验，审核通过后，用户账号的相关信息会被添加进系统，企业管理人员可通过注册的账号进
行登录。企业管理员可对该公司的客户的用户信息和分组信息进行管理，可以对用户所属的分组进行调整，不同的分组拥有不同的访问策略，企业管理员将用户调整到不同的组后会对用
户的存取权限产生影响，且用户自己无权更改。如果需要，企业管理员也可对用户的存储桶以及桶中的文件进行操作，如遇到用户恶意上传不合法的数据文件的情况，企业管理员有权
删除文件甚至整个存储桶。企业管理员用例图如图\ref{fig:企业管理员用例图}所示。

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{my_figures/chapter3/企业管理员用例图.png}
    \caption{企业管理员用例图} 
    \label{fig:企业管理员用例图}
%     \note{注：图注的内容不宜放到图题中。}
\end{figure}

\subsection{普通用户功能需求}

普通用户的功能主要就是存储桶的管理和文件的存取。用户可根据自己的需要去创建存储桶（Bucket），并且选取合适的访问策略，当然，后面在使用的过程中也可随时对Bucket的名称和访问
策略进行修改。用户还可为Bucket设置生命周期，即对象的年龄、版本数或者大小，这里系统还为过期后的提供了两种操作选择，一种是Expiry，即过期自动删除，另一种则是Transition
，即过期后转移至目标服务器。在为Bucket设置了生命周期后，系统会根据用户的选择去自动执行后续操作，从而减少手动管理对象的工作量。同时，也可以更好地控制对象的存储成本，因为过期
或不需要的对象将会自动删除或转换为低成本的存储类。

文件存取主要包括文件上传、文件下载和文件共享三个子功能。用户可同时点击多个文件进行上传或下载，界面上也会显示上传或下载的速度和状态，上传或下载的进程会因为网络波动的影响或
用户手动操作而暂停或终止。文件共享功能主要是为了方便将自己的文件设置为公共资源，当用户进行文件共享操作后，被操作的文件将可以被所有用户下载，但访问权限仍然由用户本人决定。
普通用户用例图如图\ref{fig:普通用户用例图}所示。

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{my_figures/chapter3/普通用户用例图.png}
    \caption{普通用户用例图} 
    \label{fig:普通用户用例图}

\end{figure}

\section{非功能性需求}

\subsection{性能需求}

性能作为评价整个系统的关键指标，对整个项目而言是十分重要的。本系统性能优化的重点在于高并发访问、快速响应、数据可靠性和一致性以及系统的稳定性。

（1）高并发性：由于管控平台面向的是众多用户，因此需要支持高并发的访问，以保证系统的可用性。系统需要能够支持同时有多个用户进行操作，并且不会因为并发请求过多而导致
系统崩溃或响应变慢。

（2）响应及时性：为了保证用户的良好体验，要保证用户的操作能够及时得到响应，用户、分组、策略以及文件存取等操作都要和存储服务器进行交互，尤其是当用户上传或下载多个
大文件时，需要系统能够保证在比较短的时间内完成数据的传输或及时给出状态反馈，避免长时间卡住，出现不明原因的等待或报错。

（3）数据可靠性和一致性：由于本平台是对象存储系统，用户会通过本平台向存储系统上传或者下载大量的数据文件，系统需要保证无论用户在进行任何操作时，都要保证数据的可靠性
和一致性，防止数据丢失或损坏。

（4）系统稳定性：对于存储系统的管控平台而言，系统稳定性显得尤为重要，如果管控系统频繁宕机导致用户无法正常使用存储系统，这对用户和企业都会造成巨大的影响，而且管控
平台也对整个存储系统进行着实时监控，经常性宕机也会造成维护人员无法及时的发现系统问题，存储系统若因为长时间没有修复而导致存储数据丢失或损坏将导致灾难性的损失。


\subsection{安全性需求}

本平台底层的存储系统存储着大量的用户数据，如果被不法分子非法获取到管理员的相关权限，那么用户数据将被窃取或篡改，因此保证系统的安全性至关重要。系统应采用严格的鉴权
方式对每个用户的权限进行管理，严禁用户非法访问接口，而且对用户的密码注册也要严格限制，必须使用复杂度高的密码以保证账户不会被轻易窃取。

\subsection{易用性需求}

易用性也是本系统开发的一个重要目标。操作复杂的管控系统往往会浪费大量的时间和学习成本，从而影响效率。对于用户而言，简单易用的管控系统在增强体验的同时也能很大程度上减少
失误操作，提升系统的流畅性。

\section{本章小结}

本章先针对系统的功能性和非功能性需求进行了分析，并基于系统的功能性需求得到系统的用例图和用例表，从系统管理员、企业管理员和普通用户三种角色的角度详细介绍了各个功能
需求的用例，最后分别从性能、安全性和易用性三个方面介绍了本系统的非功能性需求。本章对分布式对象存储系统管控平台的技术需求做出了具体的介绍，为后面的系统设计提供了依据。